Class {
	#name : #ChipDesignerClassicLevel,
	#superclass : #Object,
	#instVars : [
		'area',
		'ports',
		'sequences',
		'scopes'
	],
	#category : #ChipDesigner
}

{ #category : #'instance creation' }
ChipDesignerClassicLevel class >> on: area [

	^ self basicNew
		area: area;
		initialize
]

{ #category : #accessing }
ChipDesignerClassicLevel >> area [
	^ area
]

{ #category : #accessing }
ChipDesignerClassicLevel >> area: anObject [
	area := anObject
]

{ #category : #'as yet unclassified' }
ChipDesignerClassicLevel >> createLabels [

	area descriptions add: ('+Vcc' -> (3@4)).
	area descriptions add: ((ports at: 1) name -> (3@8)).
	area descriptions add: ((ports at: 2) name-> (3@12)).
	area descriptions add: ((ports at: 3) name-> (3@16)).
	area descriptions add: ((ports at: 4) name-> (3@20)).
	area descriptions add: ('+Vcc' -> (3@24)).

	area descriptions add: ('+Vcc' -> (42@4)).
	area descriptions add: ((ports at: 5) name-> (42@8)).
	area descriptions add: ((ports at: 6) name-> (42@12)).
	area descriptions add: ((ports at: 7) name -> (42@16)).
	area descriptions add: ((ports at: 8) name -> (42@20)).
	area descriptions add: ('+Vcc' -> (42@24)).
]

{ #category : #'as yet unclassified' }
ChipDesignerClassicLevel >> createScopes [

	sequences := ports with: self portPoints collect: [ :port :aPoint |
		| aSequence |
		port isInput 
			ifTrue: [ 
				aSequence := ChDSequence input name: port name.
				aSequence decodedFrom: port sequence ]
			ifFalse: [ 
				aSequence := ChDSequence output name: port name.
				aSequence expectedDecodedFrom: port expectedSequence ].
			
		aSequence forMetalAt: aPoint in: area.
		aSequence ].
	
	scopes := sequences collect: [ :each | ChDSequenceMorph on: each ]
]

{ #category : #'as yet unclassified' }
ChipDesignerClassicLevel >> initialize [ 

	super initialize.
		
	self initializeAreaWithLogo.

	ports := self portsDefinition.
	ports do: [ :each | each isInput: (each expectedSequence = 0) ].

	self createScopes.

	self initializeSimulation.
	
	self createLabels.
]

{ #category : #'as yet unclassified' }
ChipDesignerClassicLevel >> initializeArea [

	area decodeFrom: '0002C0001B000B2200C1201C12018100048200C1201C12018100004200E1201E1201A100048200E1201E1201A100004200612016120121000482006120161201210005C200C1201C12018100048200C1201C12018100004200E1201E1201A100048200E1201E1201A100004200612016120121000482006120161201210005C200C1201C12018100048200C1201C12018100004200E1201E1201A100048200E1201E1201A100004200612016120121000482006120161201210005C200C1201C12018100048200C1201C12018100004200E1201E1201A100048200E1201E1201A100004200612016120121000482006120161201210005C200C1201C12018100048200C1201C12018100004200E1201E1201A100048200E1201E1201A100004200612016120121000482006120161201210005C200C1201C12018100048200C1201C12018100004200E1201E1201A100048200E1201E1201A10000420061201612012100048200612016120121000B2'
]

{ #category : #'as yet unclassified' }
ChipDesignerClassicLevel >> initializeAreaWithLogo [

	area decodeFrom: '0002C0001B000B2200C1201C12018100048200C1201C12018100004200E1201E1201E120141201412018100042200E1201E1201A10000420061201612012100004200A1000422006120161201210000E200A10004C200C1201C120181000046202D0201900040200C1201C12018100004200E1201E1201E120141641050B00B220CB2014120141201412014120141201412014120141201412014120141201412014120141201412014120141201412014120141201412014120141201412014120141201412014120141201412014120141201E1201E1201A10000420061201612012100004620432212B000402006120161201210000E640850B00B200C120141201412014120141201412014120141201412014120141201412014120141201412014120141201412014120141201412014120141201412014120141201412018100012200C1201C12018100004200A162083200A100034200A100008200C1201C12018100004200E1201E1201E1201412014120121200612012100002200C1201412018120081000140400D0401504011040090000404001000082006120141201412014120141201E1201E1201A1000042006120161201210000C200A12004120121200E12014120181200C12014120181200C120101200C120141201810400B000040400F0401504019040090400D04015040190000C200612016120121000162002100002020092002100002200212006120101200212202100002200612014120121040070401504011040030000204003040030400B040050401300016200C1201C1201810000C0200D020110200B0200D02011000040200D02011020090200D02015020190200D02015020190200D02011000020200D020110400B00010200C1201C12018100004200E1201E1201E1201412014120181200C120181000020200702015020130200702015020110200502013000020200302007020150201B02003000020200302007020150201102003000021440B6209100004200C120141201412014120141201E1201E1201A10000420061201612012100004200A162029200A100002040050401504015040150401504015040150401504015040110200502015020130400504015040150401504015040150401504015640532012100004200A1000082006120161201210000E640250B00B200A100034200A100012200C1201C12018100004620492218B2006120141201412014120141201412014120141201412014120141201412014120141201412014120141201412014120141201412014120141201412014120141201412012100008200C1201C12018100004200E1201E1201E120141641050B00B220AB00040200E1201E1201A10000420061201612012100004620872207320141201412014120141201412014120141201412014120141201412014120141201412014120141201412014120141201412014120141201412014120141201412014120141201412014120141201412016120161201210000E200A10004C200C1201C12018100004200A100042200C1201C12018100004200E1201E1201E120141201412012100042200E1201E1201A10000420061201612012100048200612016120121000B2'
]

{ #category : #'as yet unclassified' }
ChipDesignerClassicLevel >> initializeSimulation [

	area simulation preStepBlock: [ :aSimulation |
	
		sequences do: [ :aSequence | aSequence resetRegion ].	
				
		aSimulation time > 0 ifTrue: [
			sequences with: ports do: [ :sequence :port | 
				port isInput ifTrue: [ 
					sequence updateRegionAt: aSimulation time ] ] ].

		"set Vcc after inputs so they can  overwrite them"
		(area atX: 3 y: 3) metalRegion hasVcc: true.
		(area atX: 3 y: 24) metalRegion hasVcc: true.
		(area atX: 42 y: 3) metalRegion hasVcc: true.
		(area atX: 42 y: 24) metalRegion hasVcc: true.
	].
	
]

{ #category : #'as yet unclassified' }
ChipDesignerClassicLevel >> portPoints [

	^ { 3@8. 3@12. 3@16. 3@20. 
	    42@8. 42@12. 42@16. 42@20 }
]

{ #category : #'as yet unclassified' }
ChipDesignerClassicLevel >> portsDefinition [

	self subclassResponsibility 
]

{ #category : #'as yet unclassified' }
ChipDesignerClassicLevel >> reinitialize [ 

	self initializeSimulation.
	
	self createLabels.
]

{ #category : #'as yet unclassified' }
ChipDesignerClassicLevel >> scopes [ 

	^ scopes
]
